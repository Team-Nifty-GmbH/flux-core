self.addEventListener("install",function(n){self.skipWaiting()});self.addEventListener("activate",function(n){n.waitUntil(clients.claim())});self.addEventListener("push",function(n){if(!(self.Notification&&self.Notification.permission==="granted")||!n.data)return;let t=n.data.json();const a=t.title||"Notification",i={};(t.body||t.message)&&(i.body=t.body||t.message),t.icon&&(i.icon=t.icon),t.badge&&(i.badge=t.badge),t.data&&(i.data=t.data),t.tag&&(i.tag=t.tag),t.dir&&(i.dir=t.dir),t.lang&&(i.lang=t.lang),t.requireInteraction===!0&&(i.requireInteraction=!0),t.renotify===!0&&(i.renotify=!0),t.silent===!0&&(i.silent=!0),t.vibrate&&(i.vibrate=t.vibrate),t.image&&(i.image=t.image),t.actions&&Array.isArray(t.actions)&&(i.actions=t.actions),t.timestamp&&(i.timestamp=t.timestamp),n.waitUntil(self.registration.showNotification(a,i))});self.addEventListener("notificationclick",function(n){n.notification.close();let t=null,a=n.action;!a&&n.notification.actions&&n.notification.actions.length>0&&(a=n.notification.actions[0].action),a?(a.startsWith("http://")||a.startsWith("https://")||a.startsWith("/"))&&(t=a):n.notification.data&&n.notification.data.url&&(t=n.notification.data.url),t||(t="/");let i;try{t.startsWith("http://")||t.startsWith("https://")?i=new URL(t):i=new URL(t,self.location.origin)}catch{i=new URL("/",self.location.origin)}const o=i.href;n.waitUntil(clients.matchAll({type:"window"}).then(function(s){for(let e of s)if(e.url.startsWith(self.location.origin)&&"focus"in e)return e.focus().then(()=>{const r=o===self.location.origin+"/",f=e.url===o;if(!r&&!f)return e.navigate(o)});if(clients.openWindow)return clients.openWindow(o)}))});
